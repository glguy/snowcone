.\" Text automatically generated by txt2man
.TH untitled  "31 August 2023" "" ""
.SH NAME
\fBsnowcone \fP- solanum server notice console
.SH SYNOPSIS
.nf
.fam C
\fBsnowcone\fP \fIMODE\fP [\fB--config\fP \fIPATH\fP]

.fam T
.fi
.fam T
.fi
.SH DESCRIPTION
\fBsnowcone\fP provides a live view of server notices focused on awareness
of recent connections and disconnections to the network. It can show
information about the most recent connections as well as various load
meters split by server and operators. It does this with a run-time
editable scripting environment to support rapidly adapting to the
needs of the current situation.
.PP
Instead of bundling its own network connection support, \fBsnowcone\fP relies
on the socat application to make network connections. This allows
\fBsnowcone\fP to natively support a wide range of network connection options.
.SH MODES
.TP
.B
F1
recent connections
.TP
.B
F2
server connection load
.TP
.B
F3
recent exits
.TP
.B
F4
server exit load
.TP
.B
F5
bans
.TP
.B
F6
channel creates and floods
.TP
.B
F7
network-mask connection tracker
.TP
.B
F8
raw IRC console
.TP
.B
C-n
next view
.TP
.B
C-p
previous view
.TP
.B
C-s
live filtering mode
.TP
.B
C-u
kill to beginning of buffer
.TP
.B
C-k
kill to end of buffer
.TP
.B
C-w
kill previous word
.TP
.B
M-d
kill next word
.TP
.B
C-y
paste yanked region
.TP
.B
C-a
move to beginning of buffer
.TP
.B
C-e
move to end of buffer
.TP
.B
C-f
move right
.TP
.B
C-b
move left
.TP
.B
C-t
swap characters
.TP
.B
M-f
next word
.TP
.B
M-b
previous word
.TP
.B
UP
older command history
.TP
.B
DOWN
newer command history
.TP
.B
PgUp
scroll up
.TP
.B
PgDn
scroll down
.TP
.B
Esc
clear filters, reset scroll, clear status message
.SH SH RECENT CONNECTIONS
The recent connections view has a number of special features. Click on
a connection to select it for kline or unkline. The buttons below will
allow you to set kline reasons, durations, and to see the number of
affected users before you commit to the action.
.TP
.B
Q
only live connections
.TP
.B
W
only dead connections
.TP
.B
E
all connections
.TP
.B
K
issue kline
.PP
The first column shows when a user connected. It fades from white a
character per second to indicate the most recent connections. Times
are displayed in UTC.
.PP
The second column usually shows reconnection counts for that nickname.
When a client triggers a server-side filter, this counter will switch
to showing the number of times this connection has tripped a filter.
This is indicated with an exclamation point after the number.
.PP
The third column shows the nickname, username, and hostname of the
connected user. It will be green while the user is connected and turns
red when the user disconnects. It updates when a user changes nicknames.
.PP
The fourth column can show disconnect reasons, IP addresses, and GeoIP
ASN names (in that order of preference). You can override that preference
by cycling through modes using the first button in the toolbar.
.PP
The fifth column shows the server the user is connected to.
.PP
The sixth column shows the SASL identified account name for the user,
if applicable, as well as the GECOS field.
.SH SERVER LOAD
The server load views (for connections and disconnections) provide a
view of the load rates as well as the current state of the DNS
rotations. Each column heading can be clicked in order to chose a
sort order for this view.
.PP
The rotating bar graphs show the number of events per second for the
last minute. The bar graphs max out at 8 events per second.
.PP
The load averages give an approximation of the number of connections
per second in either the last 1, 5, or 15 minutes. These varying
time windows can help interpret the numbers as showing when rates
are increasing or decreasing over time and to help put spikes into
perspective.
.PP
The various columns full of 4 and 6 show which servers have known
IPv4 and IPv6 address. They turn yellow when that address is in
the DNS rotation corresponding to the column.
.PP
The Mn column shows the MAIN rotation. The region column shows the
region a server is in and if the server is in that region's DNS
rotation. The AF column shows the IPV4 and IPV6 rotations.
.PP
The Conns column shows the number number of connections for that
server.
.PP
The Up column shows the server this server is linked to in the
direction of the configured primary_hub.
.SH RAW CLIENT
The raw client view (F8) is primarily intended for debugging. It exists
to see what \fBsnowcone\fP sees. To see details about any one message, click
on its command text.
.SH COMMANDS
You can run client commands from any window. When you startup typing
a command with a '/' character, the input buffer will replace the last
line in the client.
.TP
.B
/eval luacode
Evaluate arbitrary Lua code
.TP
.B
/filter pattern
Update the recent connection filter
using Lua pattern syntax
.TP
.B
/nettrack label address/prefix
Add a network to the F7 tracking view
.TP
.B
/quote raw_command
Send a raw IRC command
.TP
.B
/reload
Reload Lua files
.TP
.B
/sync
Manually refresh user counts
.TP
.B
/addwatch pattern
Add a new watch
.TP
.B
/delwatch number
Remove watch by number
.TP
.B
/banload
Load meters for kline setting
.TP
.B
/spamload
Load meters for filter events
.TP
.B
/repeats
List of repeated connections by nicknames and masks
.TP
.B
/stats
Internal client metrics
.TP
.B
/versions
Populate the server list version column
.TP
.B
/uptimes
Populate the server list startup column
.SH GEOIP SUPPORT
Both legacy GeoIP and modern GeoIP Maxmind database are supported
and will be used if they are found at startup time.
.SH NETWORK CONFIGURATION
Information about your network can be populated in the servers
configuration file. The MAIN, IPV4, and IPV6 regions get special
rendering treatment in the server list.
.PP
.nf
.fam C
        {
          primary_hub = 'hub.irc.tld',
          regions = {
            MAIN = { hostname = 'irc.tld' },
            US   = { hostname = 'us.irc.tld', color = 'red' },
          },
          servers = {
            'xyz.irc.tld' =
              { alias = 'Xy', region = 'US',
                ipv4 = '192.0.2.1', ipv6 = '2001:db8::16' }
          },
          kline_reasons = {
            { 'banned', 'You are banned.' },
          },
        }
.fam T
.fi
.SH SASL SUPPORT
.TP
.B
mechanism
One of the mechanisms below
.TP
.B
username
Authentication identity
.TP
.B
password
Authentication password or private key password
.TP
.B
authzid
Authorization identity
.TP
.B
key
Private key path
.PP
For password-based authentication mechanisms the password
will be used as your credential. For asymmetric cryptography
mechanisms, this will be used to decrypt the private key.
.PP
Private key files should be PEM encoded.
.PP
An optional (and very uncommon) authorization identity can be specified
with authzid.
.PP
PLAIN
EXTERNAL
ECDH-X25519-CHALLENGE
ECDSA-NIST256P-CHALLENGE
SCRAM-SHA-1
SCRAM-SHA-256
SCRAM-SHA-512
.SH FILES
~/.config/\fBsnowcone\fP/settings.lua
Connection configuration file using lua syntax
.TP
.B
~/.config/\fBsnowcone\fP/servers.lua
Lua syntax table specifying server addresses and regions.
.PP
/usr/share/\fBsnowcone\fP/dashboard
Lua run-time source files for dashboard mode
.PP
/usr/share/\fBsnowcone\fP/ircc
Lua run-time source files for ircc mode
.TP
.B
~/.config/\fBsnowcone\fP/GeoLite2-ASN.mmdb
If the mmdb Lua library is installed, and the GeoLite2-ASN.mmdb
database is in the current directory, \fBsnowcone\fP will use it to provide
more information about recent connections.
.SH AUTHOR
\fBsnowcone\fP was written by Eric Mertens <glguy@libera.chat> and is published
under the ISC license.
